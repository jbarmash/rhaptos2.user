
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Usermodel &mdash; Rhaptos2 User Server</title>
    
    <link rel="stylesheet" href="_static/flasky.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '0.0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="Rhaptos2 User Server" href="index.html" />
    <link rel="next" title="Views" href="views.html" />
    <link rel="prev" title="Testing" href="testing.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="views.html" title="Views"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="testing.html" title="Testing"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Rhaptos2 User Server</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="usermodel">
<h1>Usermodel<a class="headerlink" href="#usermodel" title="Permalink to this headline">¶</a></h1>
<p>THings to note:</p>
<span class="target" id="module-rhaptos2.user.usermodel"></span><div class="section" id="json-in-and-out">
<h2>Json in and out<a class="headerlink" href="#json-in-and-out" title="Permalink to this headline">¶</a></h2>
<p>JSON out is a realtively do-able approach - we shall define a method &#8220;todict&#8221; 
on each SA object, and this shall be manually adjusted so that when it is called
it itself calls the same method on &#8220;children&#8221; objects.  THe presumed existence of children objects is fine for our current use cases.</p>
<p>SA appears not to give decent support to determining types of relationships - but this is so unlikely it is a matter of reading their docs more now.</p>
<p>In is a interesting matter - I intend to do the simple case of one json doc, one mapping (schema specific) and then setattr work.</p>
</div>
<div class="section" id="discussion-on-serialising-rows">
<h2>Discussion on serialising rows<a class="headerlink" href="#discussion-on-serialising-rows" title="Permalink to this headline">¶</a></h2>
<p>It used to be easy to serialise a database row.  Really.
But here we are really serialsing nested objects - and the dangers that allows 
and the edge cases are aquite high.  I cannot find a simple clean and supported method to
arbitraily serialise SQ objects to dict (and on to JSON)</p>
<p>So, the best approach (and variations of this are around the
literature (you know, on the Blue Googles)) is to craft an extra
function in each SA object, that supports a serialisable function (probably __iter__)
and that function returns serialised data that we control</p>
<p>Pretty much exactly what I have been doing.</p>
<p>In short, there are ways to do this arbitrarily deep and recursive -
but the magic is deep in SA and I would worry about defending the edge
cases (</p>
<p>SA mindset - the SA mindset is (IMO) about solving the ORM bete-noir
of inheritence in relations/entites.  THat is if a professor and a
student both inherit from a person class, how is that handeled in the
database, and how to map that in the ORM. My feeling is not to do so.  However a lot of SA becomes easier to understand when you rembmer this and its iomplications.</p>
<p>Some notes:</p>
<p>sqlalchemy.ext.serializer exists to support pickling (with pickle
module) of queries, expressions and other internal SQLAlchemy objects,
it doesn&#8217;t deal with model objects. In no way it will help you to
serialize model objects to XML.
<a class="reference external" href="http://stackoverflow.com/questions/1740817/sqlalchemy-rest-serialization">http://stackoverflow.com/questions/1740817/sqlalchemy-rest-serialization</a></p>
<p><a class="reference external" href="http://trac.turbogears.org/ticket/1582">http://trac.turbogears.org/ticket/1582</a>
<a class="reference external" href="http://docs.sqlalchemy.org/en/latest/orm/relationships.html">http://docs.sqlalchemy.org/en/latest/orm/relationships.html</a>
<a class="reference external" href="https://groups.google.com/forum/?fromgroups=#!topic/sqlalchemy/hY13qaWuEGY">https://groups.google.com/forum/?fromgroups=#!topic/sqlalchemy/hY13qaWuEGY</a>
<a class="reference external" href="https://github.com/mitsuhiko/flask/blob/master/flask/json.py">https://github.com/mitsuhiko/flask/blob/master/flask/json.py</a>
<a class="reference external" href="http://pieceofpy.com/2009/08/17/sqlalchemy-and-json-w-pylons-best-practices/">http://pieceofpy.com/2009/08/17/sqlalchemy-and-json-w-pylons-best-practices/</a></p>
<p>Issues: repeating code - either use external calls or inherit
: we do not use jsonpickle - its very python specific - at least datetime transforms are ISOformat</p>
<div class="section" id="usermodel-py">
<h3>usermodel.py<a class="headerlink" href="#usermodel-py" title="Permalink to this headline">¶</a></h3>
<p>Represents the SQLALchemy classes and assoc functions, that store user
details in web server, and persist to postgres dbase.</p>
<p>We have two main models :py:class:User and :py:class:Identifier.
One User may have many identifiers, but one identifier may only have
one User.  Each identier is either a openid or a persona.</p>
<p>A user_id is a urn of form &lt;domain_of_originating_repo&gt;-&lt;uuid(4)&gt;
&#8220;org.cnx.user.f9647df6-cc6e-4885-9b53-254aa55a3383&#8221;</p>
<p>API</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">/user/:</th><td class="field-body"><p class="first">Support POST PUT GET [DELETE]
Is keyed on <em>user_id</em> - the uuid form above
/user/org.cnx.user.f9647df6-cc6e-4885-9b53-254aa55a3383
will return a <em>user profile</em> in JSON form</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">/users/:</th><td class="field-body"><p class="first">Support only GET</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">/users/:</th><td class="field-body"><dl class="first docutils">
<dt>GET - will return list of all users - is only for dev. and </dt>
<dd><p class="first last">hardcoded to max 25</p>
</dd>
</dl>
</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">/users/?fullname=bob:</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body"><dl class="first last docutils">
<dt>GET - searches the key field in User object and returns</dt>
<dd><p class="first last">JSON encoded user profiles</p>
</dd>
</dl>
</td>
</tr>
</tbody>
</table>
<p>A specialised form of the above search is</p>
<p>/user/?openid=http://xxx
<a class="reference external" href="mailto:/user/?persona=p&#37;&#52;&#48;x&#46;com">/user/?persona=p<span>&#64;</span>x<span>&#46;</span>com</a></p>
<p>These explicitly want to look up existing authetnitcatd identifiers in our dbase.
(ie part of signon process)</p>
</div>
</div>
<div class="section" id="views">
<h2>views<a class="headerlink" href="#views" title="Permalink to this headline">¶</a></h2>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">search_user():</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">post_user(&lt;dict&gt;):</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">user_id MUST NOT be present
Will overwrite all fields provided.</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">put_user(&lt;dict&gt;):</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">user_id MUST be present.
We will replace all fields provided</td>
</tr>
<tr class="field-even field"><th class="field-name" colspan="2">get_user(&lt;user_id&gt;):</th></tr>
<tr class="field-even field"><td>&nbsp;</td><td class="field-body">IF search string present, treat it as a search
else search_user</td>
</tr>
<tr class="field-odd field"><th class="field-name" colspan="2">search_user(authenticatedID):</th></tr>
<tr class="field-odd field"><td>&nbsp;</td><td class="field-body">see above</td>
</tr>
<tr class="field-even field"><th class="field-name">delete_user():</th><td class="field-body">TBD</td>
</tr>
</tbody>
</table>
<p>Matching usermodel</p>
<p>Naming convention</p>
<dl class="docutils">
<dt>distinguohs between a userprofile_dict and userprofile_json</dt>
<dd>identifier_dict and identifier_json</dd>
</dl>
<p>iterating over models</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="n">prop</span> <span class="k">for</span> <span class="n">prop</span> <span class="ow">in</span> <span class="n">usermodel</span><span class="o">.</span><span class="n">User</span><span class="o">.</span><span class="n">__mapper__</span><span class="o">.</span><span class="n">iterate_properties</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">prop</span><span class="p">,</span> <span class="n">sqlalchemy</span><span class="o">.</span><span class="n">orm</span><span class="o">.</span><span class="n">properties</span><span class="o">.</span><span class="n">RelationshipProperty</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">__getattribute__</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">key</span><span class="p">)</span>
<span class="go">[&lt;rhaptos2.user.usermodel.Identifier object at 0x8073dd890&gt;]</span>
</pre></div>
</div>
<p>This fails the smell test - a child object (relationship) has a relationship back to the parent - and no obvious way of determining the directionality or visted state (ie loops)
This is fair - parent child is only a common use case, nopt exclusive - but I want to deal with the common use case.</p>
<p>testjson = &#8216;{&#8220;interests&#8221;: null, &#8220;identifiers&#8221;: [{&#8220;identifierstring&#8221;: &#8220;<a class="reference external" href="http://fake1.example.com/">http://fake1.example.com/</a>&#8221;, &#8220;user_id&#8221;: &#8220;org.cnx.user-f7887118-74d5-4963-a0c2-04d8f863eea3&#8221;, &#8220;identifiertype&#8221;: &#8220;openid&#8221;}], &#8220;user_id&#8221;: &#8220;org.cnx.user-f7887118-74d5-4963-a0c2-04d8f863eea3&#8221;, &#8220;suffix&#8221;: null, &#8220;firstname&#8221;: null, &#8220;title&#8221;: null, &#8220;middlename&#8221;: null, &#8220;lastname&#8221;: null, &#8220;imageurl&#8221;: null, &#8220;otherlangs&#8221;: null, &#8220;affiliationinstitution_url&#8221;: null, &#8220;email&#8221;: null, &#8220;version&#8221;: null, &#8220;location&#8221;: null, &#8220;recommendations&#8221;: null, &#8220;preferredlang&#8221;: null, &#8220;fullname&#8221;: &#8220;foobar User&#8221;, &#8220;homepage&#8221;: null, &#8220;affiliationinstitution&#8221;: null, &#8220;biography&#8221;: null}&#8217;</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">usermodel</span><span class="o">.</span><span class="n">User</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">fullname</span><span class="o">=</span><span class="s">&quot;paul&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span> <span class="o">=</span> <span class="n">usermodel</span><span class="o">.</span><span class="n">Identifier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="o">.</span><span class="n">identifierstring</span> <span class="o">=</span> <span class="s">&quot;http://fake.open.id&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">i</span><span class="o">.</span><span class="n">identifiertype</span> <span class="o">=</span> <span class="s">&quot;openid&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">identifiers</span><span class="o">=</span><span class="p">[</span><span class="n">i</span><span class="p">,]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db_session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db_session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">usermodel</span><span class="o">.</span><span class="n">User</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;fullname&#39;</span><span class="p">:</span><span class="s">&#39;bob&#39;</span><span class="p">,</span> <span class="s">&#39;identifiers&#39;</span><span class="p">:[{</span><span class="s">&#39;identifierstring&#39;</span><span class="p">:</span><span class="s">&#39;http://bob@myopenid.com&#39;</span><span class="p">,</span> <span class="s">&#39;identifiertype&#39;</span><span class="p">:</span><span class="s">&#39;openid&#39;</span><span class="p">},]}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span>
<span class="go">bob-org.cnx.user-00bb0cae-970b-4fc6-87be-0b8b3da35187</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">fullname</span>
<span class="go">&#39;bob&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">identifiers</span>
<span class="go">[&lt;rhaptos2.user.usermodel.Identifier object at 0x8073e3190&gt;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">identifiers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&lt;rhaptos2.user.usermodel.Identifier object at 0x8073e3190&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">u</span><span class="o">.</span><span class="n">identifiers</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">identifierstring</span>
<span class="go">&#39;http://bob@myopenid.com&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db_session</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">db_session</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<dl class="class">
<dt id="rhaptos2.user.usermodel.Identifier">
<em class="property">class </em><tt class="descclassname">rhaptos2.user.usermodel.</tt><tt class="descname">Identifier</tt><big>(</big><em>identifierstring=None</em>, <em>identifiertype=None</em><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#Identifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.Identifier" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>The external-to-cnx, globally unique identifer string that </dt>
<dd>is the &#8216;username&#8217; a person claims to be, and needs verification
from a thrid party to us, the relying party.</dd>
</dl>
<p>A leaf node as it were (no children in ER diagram)</p>
<p>The multiple inheritence from CNXBase gives us a range of to and from JSON methods
These are mostly overridden in User below. Cut and Paste occurs but is iminimised with  inheritence.</p>
</dd></dl>

<dl class="class">
<dt id="rhaptos2.user.usermodel.User">
<em class="property">class </em><tt class="descclassname">rhaptos2.user.usermodel.</tt><tt class="descname">User</tt><big>(</big><em>user_id=None</em>, <em>**kwds</em><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#User"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.User" title="Permalink to this definition">¶</a></dt>
<dd><p>declarative class for user_details</p>
<p>1. setattr and getattr are the &#8220;frontdoors&#8221; for SA - __dict__
manipluatins are ignored</p>
<ol class="arabic simple" start="2">
<li>This gives us a good in for pushing JSON to the db</li>
</ol>
<dl class="method">
<dt id="rhaptos2.user.usermodel.User.from_dict">
<tt class="descname">from_dict</tt><big>(</big><em>userprofile_dict</em><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#User.from_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.User.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>We only support pushing JSON in - one object at a time There
is no obvious way to do it automatically over a hierarchy, so
manually look for the &#8220;realtions&#8221; and add them.  (backrefs
seriously complicate the obvious attack vector here)</p>
<p>Accepts: userprofile as defined in XXX</p>
</dd></dl>

<dl class="method">
<dt id="rhaptos2.user.usermodel.User.jsonify">
<tt class="descname">jsonify</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#User.jsonify"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.User.jsonify" title="Permalink to this definition">¶</a></dt>
<dd><p>Helper function that returns simple json repr</p>
</dd></dl>

<dl class="method">
<dt id="rhaptos2.user.usermodel.User.safe_type_out">
<tt class="descname">safe_type_out</tt><big>(</big><em>col</em><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#User.safe_type_out"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.User.safe_type_out" title="Permalink to this definition">¶</a></dt>
<dd><p>return the value of a coulmn field safely as something that json can use
This is essentially a JSONEncoder sublclass inside object - ...</p>
</dd></dl>

<dl class="method">
<dt id="rhaptos2.user.usermodel.User.set_new_id">
<tt class="descname">set_new_id</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#User.set_new_id"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.User.set_new_id" title="Permalink to this definition">¶</a></dt>
<dd><p>If we are new user, be able to create uuid</p>
<p>### .. todo: A new User() autosets uuid. Is this correct
### behaviour?</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">u</span> <span class="o">=</span> <span class="n">User</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">set_new_id</span><span class="p">()</span> <span class="c"># +doctest.ELLIPSIS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">assert</span> <span class="n">x</span> <span class="o">==</span> <span class="n">u</span><span class="o">.</span><span class="n">user_id</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="rhaptos2.user.usermodel.User.to_dict">
<tt class="descname">to_dict</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#User.to_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.User.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Return self as a dict, suitable for jsonifying</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="rhaptos2.user.usermodel.delete_user">
<tt class="descclassname">rhaptos2.user.usermodel.</tt><tt class="descname">delete_user</tt><big>(</big><em>security_token</em>, <em>user_id</em><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#delete_user"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.delete_user" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rhaptos2.user.usermodel.get_all_users">
<tt class="descclassname">rhaptos2.user.usermodel.</tt><tt class="descname">get_all_users</tt><big>(</big><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#get_all_users"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.get_all_users" title="Permalink to this definition">¶</a></dt>
<dd><p>FOr search functionality</p>
</dd></dl>

<dl class="function">
<dt id="rhaptos2.user.usermodel.get_user">
<tt class="descclassname">rhaptos2.user.usermodel.</tt><tt class="descname">get_user</tt><big>(</big><em>user_id</em><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#get_user"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.get_user" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a User object, when provided with user_id</p>
</dd></dl>

<dl class="function">
<dt id="rhaptos2.user.usermodel.get_user_by_identifier">
<tt class="descclassname">rhaptos2.user.usermodel.</tt><tt class="descname">get_user_by_identifier</tt><big>(</big><em>unquoted_id</em><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#get_user_by_identifier"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.get_user_by_identifier" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="rhaptos2.user.usermodel.get_user_by_name">
<tt class="descclassname">rhaptos2.user.usermodel.</tt><tt class="descname">get_user_by_name</tt><big>(</big><em>namefrag</em><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#get_user_by_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.get_user_by_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a case insensitive search on fullname</p>
<p>I would like to offer at least two other searches, 
specifying the fields to search, and a frag search across 
many fields.</p>
</dd></dl>

<dl class="function">
<dt id="rhaptos2.user.usermodel.mkobjfromlistofdict">
<tt class="descclassname">rhaptos2.user.usermodel.</tt><tt class="descname">mkobjfromlistofdict</tt><big>(</big><em>o</em>, <em>l</em><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#mkobjfromlistofdict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.mkobjfromlistofdict" title="Permalink to this definition">¶</a></dt>
<dd><p>Glimmering of recursion style needed
However too fragile...</p>
</dd></dl>

<dl class="function">
<dt id="rhaptos2.user.usermodel.parse_json_user_schema">
<tt class="descclassname">rhaptos2.user.usermodel.</tt><tt class="descname">parse_json_user_schema</tt><big>(</big><em>jsonstr</em><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#parse_json_user_schema"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.parse_json_user_schema" title="Permalink to this definition">¶</a></dt>
<dd><p>Ul;timately we should have multiple version handling.</p>
</dd></dl>

<dl class="function">
<dt id="rhaptos2.user.usermodel.populate_user">
<tt class="descclassname">rhaptos2.user.usermodel.</tt><tt class="descname">populate_user</tt><big>(</big><em>incomingd</em>, <em>userobj</em><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#populate_user"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.populate_user" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a dict, and a User object, push dict into User object and return it.</p>
</dd></dl>

<dl class="function">
<dt id="rhaptos2.user.usermodel.post_user">
<tt class="descclassname">rhaptos2.user.usermodel.</tt><tt class="descname">post_user</tt><big>(</big><em>jsond</em><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#post_user"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.post_user" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a dict representing the complete set
of fields then create a new user and those fields</p>
<p>I am getting a dictionary direct form Flask request object - want
to handle that myself with parser.</p>
<p>returns User object, for later saveing to DB</p>
</dd></dl>

<dl class="function">
<dt id="rhaptos2.user.usermodel.put_user">
<tt class="descclassname">rhaptos2.user.usermodel.</tt><tt class="descname">put_user</tt><big>(</big><em>jsond</em>, <em>user_id</em><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#put_user"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.put_user" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a user_id, and a json_str representing the &#8220;Updated&#8221; fields
then update those fields for that user_id</p>
</dd></dl>

<dl class="function">
<dt id="rhaptos2.user.usermodel.verify_schema_version">
<tt class="descclassname">rhaptos2.user.usermodel.</tt><tt class="descname">verify_schema_version</tt><big>(</big><em>versionstr</em><big>)</big><a class="reference internal" href="_modules/rhaptos2/user/usermodel.html#verify_schema_version"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#rhaptos2.user.usermodel.verify_schema_version" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a placeholder only.  
.. todo:: Handle versions sensibly</p>
</dd></dl>

</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/rhaptos2userlogo.jpg" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Usermodel</a><ul>
<li><a class="reference internal" href="#json-in-and-out">Json in and out</a></li>
<li><a class="reference internal" href="#discussion-on-serialising-rows">Discussion on serialising rows</a><ul>
<li><a class="reference internal" href="#usermodel-py">usermodel.py</a></li>
</ul>
</li>
<li><a class="reference internal" href="#views">views</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="testing.html"
                        title="previous chapter">Testing</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="views.html"
                        title="next chapter">Views</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/usermodel.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="views.html" title="Views"
             >next</a> |</li>
        <li class="right" >
          <a href="testing.html" title="Testing"
             >previous</a> |</li>
        <li><a href="index.html">Rhaptos2 User Server</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Authors.txt.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>